<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="io.spring.infrastructure.mybatis.mapper.PurchaseMapper">
    <select id="selectPurchaseListByCondition" resultType="HashMap">
        <![CDATA[
        select a.purchase_no,
               b.purchase_seq,
               a.purchase_vendor_id,
               b.assort_id,
               b.item_id,
               b.purchase_qty,
               b.purchase_unit_amt,
               b.site_order_no,
               (select b1.option_nm
                from ititmm b2, itvari b1
                where b2.assort_id=b.assort_id
                  And b2.item_id= b.item_id
                  And  b2.assort_id = b1.assort_id
                  and b2.variation_gb1 = b1.variation_gb
                  and  b2.variation_seq1=b1.seq) opt1,
               (select b1.option_nm
                from ititmm b2, itvari b1
                where b2.assort_id=b.assort_id
                  And b2.item_id= b.item_id
                  And  b2.assort_id = b1.assort_id
                  and b2.variation_gb2 = b1.variation_gb
                  and  b2.variation_seq2=b1.seq) opt2
        from lspchm a,
             lspchd b
        where a.purchase_dt between #{startDt} and #{endDt}
          and a.purchase_vendor_id = #{purchaseVendorId}
          and a.purchase_no = b.purchase_no
          and b.assort_id = #{assortId}
          and a.purchase_status = #{purchaseStatus}
        ]]>
    </select>
</mapper>

